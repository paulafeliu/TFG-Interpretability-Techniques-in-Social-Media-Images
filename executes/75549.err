The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
Palette images with Transparency expressed in bytes should be converted to RGBA images
Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
Traceback (most recent call last):
  File "/fhome/pfeliu/tfg_feliu/TFG-Interpretability-Techniques-in-Social-Media-Images/code/main.py", line 465, in <module>
    device=device,
  File "/fhome/pfeliu/tfg_feliu/TFG-Interpretability-Techniques-in-Social-Media-Images/code/main.py", line 451, in main
    #run_shap(model, test_dataset, device)
  File "/export/fhome/pfeliu/tfg_feliu/TFG-Interpretability-Techniques-in-Social-Media-Images/code/interpretability/gradcam_backprop2.py", line 164, in apply_gradcam_all
    apply_gradcam(
  File "/export/fhome/pfeliu/tfg_feliu/TFG-Interpretability-Techniques-in-Social-Media-Images/code/interpretability/gradcam_backprop2.py", line 121, in apply_gradcam
    cam = gradcam.generate(inp, cls)       # HÃ—W in [0..1]
  File "/export/fhome/pfeliu/tfg_feliu/TFG-Interpretability-Techniques-in-Social-Media-Images/code/interpretability/gradcam_backprop2.py", line 59, in generate
    cam += w * activ[i]
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
